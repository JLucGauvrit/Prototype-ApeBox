#prototype ApeBox

services:

  openwebui:
    image: ghcr.io/open-webui/open-webui:latest
    container_name: openwebui
    #restart: always
    ports: [ "8080:8080" ]
    volumes:
      - ./data/llm:/root/.cache
    environment:
      - OPENAI_API_BASE_URL=http://vllm:8000/v1

  n8n:
    image: n8nio/n8n
    container_name: n8n
    restart: always
    ports: [ "5678:5678" ]
    environment:
      - GENERIC_TIMEZONE=Europe/Paris
      - N8N_BASIC_AUTH_ACTIVE=true
      - N8N_BASIC_AUTH_USER=admin
      - N8N_BASIC_AUTH_PASSWORD=apebox
    volumes:
      - ./data/n8n:/home/node/.n8n

  nextcloud:
    image: nextcloud
    container_name: nextcloud
    restart: always
    ports: [ "8081:80" ]
    volumes:
      - ./data/nextcloud:/var/www/html
    environment:
      - NEXTCLOUD_ADMIN_USER=admin
      - NEXTCLOUD_ADMIN_PASSWORD=apebox

  apeui:
    build: ./apeui
    container_name: apeui
    develop:
      watch:
        - path: ./apeui
          target: /app
          action: sync+restart
    restart: always
    ports:
      - "80:8080"
    volumes:
       - /var/run/docker.sock:/var/run/docker.sock
